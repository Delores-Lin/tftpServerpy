define("article:widget/exp-video/izhishi-video/izhishi-video.js",function(i,e){function o(){var i={m3u8:u.m3u8PlayUrl,mp4:u.mp4PlayUrl,playUrl:u.playUrl},e=n(),o={apis:{playrate:[.5,.75,1,1.5,2],poster:u.coverUrl||"",autoplay:!1,fullscreen:!0,muted:!1,miniSwitch:!0,autoMini:!0,logKey:"jingyan-pc",theme:"#51c83d",selectorTheme:"#51c83d",smallControl:!0,miniStyle:{left:e,bottom:10,width:352,height:198}},urlList:i,onRef:function(i){p=i}};window.articleReact&&window.articleReact.appendHaoKanPlayer&&window.articleReact.appendHaoKanPlayer("video-originate-box",o)}function n(){var i,e=document.documentElement.clientWidth,o=parseInt(z.width(),10);return i=e>(q?1256:1200)?(e-o)/2+(o-O):e-(O+72)}function t(){if(h){var i=n();p.changeMiniPosition({left:i,bottom:10})}}function d(i,e,n){u=i,j({action:"show",isFirstShow:!0});var d=window.navigator.userAgent.toLowerCase();(d.match(/msie\s\d+/)&&d.match(/msie\s\d+/)[0]||d.match(/trident\s?\d+/)&&d.match(/trident\s?\d+/)[0])&&(window.ieVersion=d.match(/msie\s\d+/)[0].match(/\d+/)[0]||d.match(/trident\s?\d+/)[0],window.ieVersion<8&&(T(".douwan-video-name").html("哎呀，当前浏览器无法播放该视频，请升级到最新版本的浏览器。"),T(".douwan-video-dur").html('<a href="/article/fdbd4277c385f2b89e3f488c.html" target="_blank">如何升级？</a>'),T(".douwan-video-play").remove(),T(".douwan-video-pic").removeClass("douwan-video-pic").addClass("no-support-image")));var m=.8*i.duration,f=T(".wgt-douwan-video-rec"),w=!1;if(f.length){o(),p&&(T(".video-originate-pic",f).hide(),p.on("pause",function(){var e=p.currentTime(),o=e-y,t=Math.floor(e/i.duration*100);t>=G&&(G=t,v(t,i.encVid,n,i.videoType)),j({action:"video-stop",stopTime:e,playedTime:o,videoDuration:u.duration}),L=!0}),p.on("play",function(){w?(j({action:"video-play",beginTime:p.currentTime(),videoDuration:u.duration}),y=p.currentTime()):(y=p.currentTime(),g.send(location.href,2019,{pos:"video-exp-izhishi",action:"vv",intention:"autoPlay-log",videoplay:"G2"===e?1:0,videoGroup:e,videoType:i.videoType}),j({action:"click-play",videoDuration:u.duration}),r(i,e,n),w=!0),T(".video-originate-pic",f).hide()}),p.on("ended",function(){a(),T(".video-originate-pic",f).show(),U&&k({action:"over"}),U=!1,S=!1,P=0,C=[0],D=0,I=!1,E[4]||(E[0]=E[1]=E[2]=E[3]=E[4]=!0,G=100,v(100,i.encVid,n,i.videoType),g.send(location.href,2019,{pos:"izhishi-video",action:"ended",videoType:i.videoType,videoGroup:e,encVid:i.encVid,eidEnc:n}))}),p.on("timeupdate",function(){var o=p.currentTime(),t=Math.floor(o/i.duration*100);t>G&&(G=t),s(t,E,i.encVid,n,i.videoType),o>=m?(!U&&S&&(k({action:"done"}),U=!0),S=!1):(U=!1,S||(l(i,e,n),S=!0)),c()}),p.on("error",function(){j({action:"play-err"})}),p.on("fullscreen",function(){p.checkVideoLevel()}),p.on("mini",function(i){i!==h&&(i?!R.hasClass("with-video")&&R.addClass("with-video"):R.hasClass("with-video")&&R.removeClass("with-video"),p.checkVideoLevel()),h=i})),x.on("click",".box-body",function(){T(this).hide(),f.show(),T(".douwan-video-detail-box").removeClass("more"),p.play(),g.send(location.href,2019,{pos:"douwan-video",action:"click",videoplay:"G1"===e?1:0,videoGroup:e}),S||(l(i,e,n),S=!0)});var z=T(".video-originate-pic",f);z.on("click",function(){p&&p.play()}),T(window).on("unload",function(){var e=p&&p.currentTime()||0,o=Math.floor(e/i.duration*100);o>=G&&(G=o,v(o,i.encVid,n,i.videoType))})}T("body").on("click",".video-originate-close",function(){p.pause(),T(".wgt-douwan-video-rec").hide(),T(".douwan-video-detail").show(),T(".douwan-video-detail-box").addClass("more")});var M=T(".wgt-douwan-video-originate");if(M.length){var _=T(".video-originate-pic",M);_.on("click",function(){p||(o(),w||(g.send(location.href,2019,{pos:"video-exp-izhishi",action:"vv",intention:"autoPlay-log",videoplay:"G2"===e?1:0,videoGroup:e,videoType:i.videoType}),j({action:"click-play",videoDuration:u.duration}),r(i,e,n),w=!0),g.send(location.href,2019,{pos:"izhishi-video",action:"play",videoType:i.videoType,videoGroup:e,videoplay:"G2"===e?1:0,encVid:i.encVid,eidEnc:n}),S||(l(i,e,n),S=!0),p.on("pause",function(){var e=p.currentTime(),o=e-y,t=Math.floor(e/i.duration*100);t>=G&&(G=t,v(t,i.encVid,n,i.videoType)),j({action:"video-stop",stopTime:e,playedTime:o,videoDuration:u.duration}),L=!0}),p.on("play",function(){w?(j({action:"video-play",beginTime:p.currentTime(),videoDuration:u.duration}),y=p.currentTime()):(y=p.currentTime(),g.send(location.href,2019,{pos:"video-exp-izhishi",action:"vv",intention:"autoPlay-log",videoplay:"G2"===e?1:0,videoGroup:e,videoType:i.videoType}),j({action:"click-play",videoDuration:u.duration}),r(i,e,n),w=!0)}),p.on("ended",function(){a(),U&&k({action:"over"}),U=!1,S=!1,P=0,C=[0],D=0,I=!1,E[4]||(E[0]=E[1]=E[2]=E[3]=E[4]=!0,G=100,v(100,i.encVid,n,i.videoType),g.send(location.href,2019,{pos:"izhishi-video",action:"ended",videoType:i.videoType,videoGroup:e,encVid:i.encVid,eidEnc:n}))}),p.on("timeupdate",function(){var o=p.currentTime(),t=Math.floor(o/i.duration*100);t>G&&(G=t),s(t,E,i.encVid,n,i.videoType),o>=m?(!U&&S&&(k({action:"done"}),U=!0),S=!1):(U=!1,S||(l(i,e,n),S=!0)),c()}),p.on("error",function(){j({action:"play-err"})}),p.on("fullscreen",function(){p.checkVideoLevel()}),p.on("mini",function(i){i!==h&&(i?!R.hasClass("with-video")&&R.addClass("with-video"):R.hasClass("with-video")&&R.removeClass("with-video"),p.checkVideoLevel()),h=i}),p.play(),_.hide()),T(window).on("unload",function(){if(p){var e=Math.floor(p.currentTime()/i.duration*100);e>=G&&(G=e,v(e,i.encVid,n,i.videoType))}}),g.send(location.href,2019,{pos:"izhishi-video",action:"click",videoType:i.videoType,videoGroup:e,encVid:i.encVid,eidEnc:n}),S||(j({action:"click-play",videoDuration:u.duration}),l(i,e,n),S=!0)}),"G2"===e&&_.trigger("click")}T(window).on("resize",t),new V({target:T(".video-originate-accuse"),video:i}),g.send(location.href,2019,{pos:"izhishi-video",action:"show",videoType:i.videoType,videoGroup:e,encVid:i.encVid,eidEnc:n}),g.send(location.href,2019,{pos:"video-exp-izhishi",action:"pv",intention:"autoPlay-log",videoplay:"G2"===e?1:0,videoGroup:e,videoType:i.videoType}),b(location.href,2019,{name:"VIDEO_SHOW",act:"view",videoId:i.encVid,eidEnc:n,videoType:i.videoType}),k({action:"show"})}function a(){var i=p.currentTime(),e=i-y;j({action:"play-end",stopTime:i,playedTime:e,videoDuration:u.duration})}function c(){if(f=p.currentTime(),m=Math.abs(f-D),m>M){if(C.push(0),P=f,L)L=!1;else{var i=D-y;j({action:"video-stop",stopTime:D,playedTime:i,videoDuration:u.duration}),j({action:"video-play",beginTime:f,videoDuration:u.duration})}y=f}else{var e=Math.abs(f-P);C[C.length-1]=e}D=f,I||(w=C.reduce(function(i,e){return i+e}),w>3&&(j({action:"valid-play"}),I=!0))}function r(i,e,o){T.ajax({url:"/submit/izhishidatapoint?method=addIzhishiPlayPoint",type:"post",dataType:"json",data:{izhishiVid:i.encVid,bdStoken:F.context("BdStoken"),bdstt:F.context("bdstt")}}),b(location.href,2019,{name:"VIDEO_PLAY",act:"clk",videoId:i.encVid,autoPlay:"G2"===e?1:0,eidEnc:o,videoType:i.videoType})}function l(){k({action:"play"})}function v(i,e,o,n){b(location.href,2019,{name:"VIDEO_PLAY_TIME",act:"other",videoId:e,percentage:i,eidEnc:o,videoType:n})}function s(i,e,o,n,t){i>=25&&50>i?e[0]||(e[0]=!0,v(25,o,n,t)):i>=50&&75>i?e[1]||(e[1]=!0,v(50,o,n,t)):i>=75&&80>i?e[2]||(e[2]=!0,v(75,o,n,t)):i>=80&&(e[3]||(e[3]=!0,v(80,o,n,t),g.send(location.href,2019,{pos:"izhishi-video",action:"video-tail",videoType:t,encVid:o,eidEnc:n})))}var u,p,h,y,m,f,w,T=i("common-jquery:widget/lib/jquery/jquery.js"),g=i("common-jquery:widget/js/logic/log/log.js"),V=i("article:widget/ui/accuse/accuse.js"),b=i("article:widget/js/logic/nslog-izhishi/nslog-izhishi.js"),k=i("article:widget/js/logic/nslog-exp/nslog-exp.js").videoExpSend,j=i("article:widget/js/logic/nslog-exp/nslog-exp.js").videoLogSend,x=T(".wgt-douwan-video"),z=T(".content-container"),G=0,E=[!1,!1,!1,!1,!1],P=0,C=[0],D=0,M=1,I=!1,L=!1,S=!1,U=!1,_=F.context("moduleParams"),q=_&&"business"===_.page,O=352,R=T("#tts-player-item");e.init=d});