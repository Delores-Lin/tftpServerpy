define("article:widget/ui/lazyload/lazyload.js",function(t,e,o){var i=t("common-jquery:widget/lib/tangram/base/base.js"),n=(t("common-jquery:widget/lib/tangram/fx/fadeIn/fadeIn.js"),t("common-jquery:widget/js/util/event/event.js"),function(t,e){var o=arguments.callee;return this instanceof o?("undefined"==typeof e&&(e=t,t=e.container),t=t?i.g(t):document,this.containers=i.lang.toArray(t),this.options={lazyCls:"lazy-load-img",dataSrc:"data-src",diff:250,isCheckAttr:"data-is-check",imgAttr:["width","height","style"]},i.object.extend(this.options,e),this.images=[],this.loaded=[],void this.init()):new o(t,e)});n.prototype={init:function(){this.filterItems(),this.images.length>0&&this.initLoadEvent()},filterItems:function(){this.images=i.lang.toArray(i.q(this.options.lazyCls))},initLoadEvent:function(){function t(){e||(e=setTimeout(function(){o.loadItems(),0===o.images.length&&o.destroy(),e=null},100))}var e,o=this;i.event.on(window,"scroll",t),i.event.on(window,"resize",t),o._loadFn=t,o.images.length>0&&i.dom.ready(t)},loadItems:function(){var t=this;this.images=i.array.filter(this.images,function(e){var o=i.dom.getAttr(e,this.options.dataSrc);return o?t.checkElemInViewport(e)?(t.loadImage(e,o),!1):!0:!1},this)},loadImage:function(t,e){var o=this;e&&t.src!==e&&(t.onload=function(){var e=this;if(!e.src.match(/exp_loading\.gif/i)){if(i.dom.getAttr(e,o.options.isCheckAttr))for(var n=null,a=o.options.imgAttr,s=a.length-1;s>=0;s--)n=i.dom.getAttr(e,"data-"+a[s]),n&&(i.dom.setAttr(e,a[s],n),e.removeAttribute("data-"+a[s]),n=null);i.fx.fadeIn(t,{duration:800}),i.dom.removeClass(t,o.options.lazyCls),e.onload=null}},t.src=e,t.removeAttribute(o.options.dataSrc))},isCross:function(t,e){var o={};return o.top=Math.max(parseFloat(t.top),parseFloat(e.top)),o.bottom=Math.min(parseFloat(t.bottom),parseFloat(e.bottom)),o.left=Math.max(parseFloat(t.left),parseFloat(e.left)),o.right=Math.min(parseFloat(t.right),parseFloat(e.right)),o.bottom>=o.top&&o.right>=o.left},isWindow:function(t){return!!t.window&&t.window===t.window.window},getBoundingRect:function(t){var e,o,n,a;if(void 0===t||this.isWindow(t)||9===t.nodeType)e=i.page.getViewHeight(),o=i.page.getViewWidth(),n=i.page.getScrollLeft(),a=i.page.getScrollTop();else{e=t.offsetHeight,o=t.offsetWidth;var s=i.dom.getPosition(t);n=s.left,a=s.top}var r=this.options.diff,l=0===r?o:r,d=0,f=l,g=0===r?e:r,h=0,m=g,c=n+o,u=a+e;return"object"==typeof r&&(d=r.left||0,f=r.right||0,h=r.top||0,m=r.bottom||0),n-=d,c+=f,a-=h,u+=m,{left:n,top:a,right:c,bottom:u}},checkElemInViewport:function(t){var e=i.dom.getPosition(t),o=e.left,n=e.top,a=this.getBoundingRect(),s={left:o,top:n,right:o+t.offsetWidth,bottom:n+t.offsetHeight};return this.isCross(a,s)},destroy:function(){var t=this._loadFn;i.event.un(window,"scroll",t),i.event.un(window,"resize",t)}},o.exports=n});